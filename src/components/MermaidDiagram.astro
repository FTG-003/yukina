---
// Componente: MermaidDiagram.astro
// Utilizzo: 
// <MermaidDiagram>
//   graph TD
//     A --> B
// </MermaidDiagram>
---

<div class="mermaid">
    <slot is:raw />
</div>

<script is:inline>
  function renderMermaid() {
    if (window.mermaid) {
      window.mermaid.run({
        nodes: document.querySelectorAll('.mermaid')
      });
    }
  }

  if (window.mermaid) {
    renderMermaid();
  } else {
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js';
    script.onload = () => {
      window.mermaid.initialize({ startOnLoad: false });
      renderMermaid();
    };
    document.head.appendChild(script);
  }
</script>

<style>
.mermaid {
    background: var(--theme-bg);
    padding: 1.5rem;
    border-radius: 8px;
    margin: 1.5rem 0;
    box-shadow: var(--theme-shadow);
    overflow: auto;
}
</style>